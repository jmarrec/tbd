<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>
  File: README
  
    &mdash; Documentation by YARD 0.9.26
  
</title>

  <link rel="stylesheet" href="css/style.css" type="text/css" />

  <link rel="stylesheet" href="css/common.css" type="text/css" />

<script type="text/javascript">
  pathId = "README";
  relpath = '';
</script>


  <script type="text/javascript" charset="utf-8" src="js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="js/app.js"></script>


  </head>
  <body>
    <div class="nav_wrap">
      <iframe id="nav" src="class_list.html?1"></iframe>
      <div id="resizer"></div>
    </div>

    <div id="main" tabindex="-1">
      <div id="header">
        <div id="menu">
  
    <a href="_index.html">Index</a> &raquo; 
    <span class="title">File: README</span>
  
</div>

        <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="class_list.html">

        <svg width="24" height="24">
          <rect x="0" y="4" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="12" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="20" width="24" height="4" rx="1" ry="1"></rect>
        </svg>
    </a>
  
</div>
        <div class="clear"></div>
      </div>

      <div id="content"><div id='filecontents'>
<h1 id="label-Thermal+Bridging+-26+Derating+-28tbd-29">Thermal Bridging &amp; Derating (tbd)</h1>

<p>This is a repo for an OpenStudio Measure that <em>thermally derates</em>
outside-facing opaque constructions (walls, roofs and exposed floors),
based on <em>major</em> thermal bridges (balconies, corners, fenestration
perimeters, and so on). It relies on both the OpenStudio API and the
AutomaticMagic <a
href="https://github.com/automaticmagic/topolys">Topolys</a> gem.</p>

<p>Within the context of building energy simulation (and as required by recent
building energy codes and standards) a construction&#39;s nominal R-value
(or inversely, its nominal U-value) should ideally be <em>derated</em> to
adequately factor-in <em>minor</em> and <em>major</em> thermal bridging.
<em>Minor</em> thermal bridging is attributable to regularly-spaced framing
(such as studs, Z-bars, etc.): the resulting derated R-value from minor
thermal bridging, generally known as a construction&#39;s <em>clear-field
effective R-value</em>, is typically independent of a surface&#39;s actual
geometry or adjacencies to other surfaces. <em>Major</em> thermal bridging
instead relates to a surface&#39;s geometry and its immediate adjacencies
(e.g. parapet along a roof/wall intersection, rim joists, wall corners),
protruding surfaces and penetrations (e.g. cantilevered balconies), etc.
The measure loops through an OpenStudio model&#39;s outside-facing
surfaces, identifies shared <em>edges</em> with nearby envelope, floor slab
and shading surfaces (a proxy for cantilevered balconies), applies (from a
list of arguments - e.g. <em>poor</em>, <em>regular</em>,
<em>efficient</em>) predefined linear conductance sets (PSI-values, in W/K
per linear meter) to individual edge lengths (in m), and consequently
derates a construction&#39;s clear-field effective R-value. Users of the
measure should observe new, surface-specific constructions to their OSM
model and/or file, as well as systematic increases in construction U-values
(i.e. decreases in insulating material thickness). The method and
predefined values are taken from published research and standards such as
ASHRAE&#39;s <a
href="https://www.techstreet.com/standards/rp-1365-thermal-performance-of-building-envelope-details-for-mid-and-high-rise-buildings?product_id=1806751">RP-1365</a>,
<a
href="https://www.bchydro.com/powersmart/business/programs/new-construction.html">BETBG</a>
&amp; <a href="https://thermalenvelope.ca">thermalenvelope.ca</a>, as well
as ISO <a href="https://www.iso.org/standard/65710.html">10211</a> and <a
href="https://www.iso.org/standard/65706.html">14683</a>.</p>

<h2 id="label-TO+DO">TO DO</h2>

<p><a href="https://github.com/rd2/tbd/issues">Enhancements</a> and
documentation are planned over the next few weeks and months, including: 1.
JSON I/O - <em>completed</em> 2. dealing with ground-facing surfaces (e.g.
KIVA foundations) - <em>completed</em> 3. dealing with fully-glazed
surfaces with thermal bridges 4. adding point conductances -
<em>completed</em> 5. generating building-level clear-field R-values 6.
dealing with multipliers and spanners 7. logging warnings and errors 8.
guide material, case examples, how-to&#39;s</p>

<p>Submit <a href="https://github.com/automaticmagic/topolys/issues">here</a>
issues or desired enhancements more closely linked to Topolys.</p>

<p>Energy modelers simply interested in using the TBD OpenStudio
<em>measure</em> can either download the latest <a
href="https://github.com/rd2/tbd/releases">release</a> or access the
measure via NREL&#39;s <a href="https://bcl.nrel.gov">BCL</a> … search for
<em>bridging</em> or <em>rd2</em>. The following installation and testing
instructions are for those interested in exploring/tweaking the code
(cloned or forked version of TBD). The following should refer to OpenStudio
2.9.1, yet the measure is regularly tested against OpenStudio 3.0.0.</p>

<h2 id="label-Windows+Instructions">Windows Instructions</h2>

<h3 id="label-Installation">Installation</h3>

<p>Install Ruby using the <a
href="https://rubyinstaller.org/downloads/archives/">RubyInstaller</a> for
<a
href="https://dl.bintray.com/oneclick/rubyinstaller/rubyinstaller-2.2.5-x64.exe">Ruby
2.2.5 (x64)</a>.</p>

<p>Check the ruby installation returns the correct Ruby version (2.2.5):
<code> ruby -v </code></p>

<p>Install bundler from the command line <code> gem install bundler -v 1.17.3
</code></p>

<p>Install <a
href="https://github.com/NREL/OpenStudio/releases/tag/v2.9.1">OpenStudio
2.9.1</a>. Create a file
<code>C:\ruby-2.2.5-x64-mingw32\lib\ruby\site_ruby\openstudio.rb</code> and
point it to your OpenStudio installation by editing the contents. E.g.:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_require'>require</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>C:\openstudio-2.9.1\Ruby\openstudio.rb</span><span class='tstring_end'>&#39;</span></span>
</code></pre>

<p>Verify your OpenStudio and Ruby configuration: <code> ruby -e &quot;require
&#39;openstudio&#39;&quot; -e &quot;puts OpenStudio::Model::Model.new&quot;
</code></p>

<p>Run basic tests to ensure the measure operates properly (see end of this
README).</p>

<h2 id="label-Run+tests+using+Docker">Run tests using Docker</h2>

<p>Install Docker for Windows: <code>
https://docs.docker.com/docker-for-windows/install/ </code></p>

<p>Pull the OpenStudio 2.9.1 Docker image: <code> docker pull
nrel/openstudio:2.9.1 </code></p>

<p>In the root repository: <code> docker run --name test --rm -d -t -v
${PWD}:/work -w /work nrel/openstudio:2.9.1 docker exec -t test bundle
update docker exec -t test bundle exec rake update_library_files docker
exec -t test bundle exec rake docker kill test </code></p>

<h2 id="label-MacOS+-28e.g.+Catalina+10.15.4-29+Instructions">MacOS (e.g. Catalina 10.15.4) Instructions</h2>

<p>OpenStudio <a
href="https://github.com/NREL/OpenStudio/releases/tag/v2.9.1">2.9.1</a> is
the most up-to-date version that remains <a
href="https://github.com/NREL/OpenStudio/wiki/OpenStudio-Version-Compatibility-Matrix">compatible</a>
with SketchUp 2017. OpenStudio 2.9.1 measures require Ruby 2.2.5, which is
several iterations behind the default Ruby 2.6 version available on any
recently-purchased Mac. Although it is quite common for developers to have
access to more than one Ruby version, some effort is required for Ruby
versions &lt; 2.3 (e.g. 2.2.5 is no longer officially supported, it
requires OpenSSL-1.0 (not 1.1) which is considered deprecated). To help Mac
users (and potentially Linux users as well), the following steps are
recommended (although architecture-specific tweaks may be required).</p>

<p>From a Terminal, install <a href="https://brew.sh/index">Homebrew</a> -
nice for package distribution and management. With a few tweaks, it will
handle most package downloads, dependencies, etc. Using Homebrew, install
OpenSSL-1.0, and then <em>rbenv</em> (which allows users to manage multiple
Ruby versions). One way of doing it:</p>

<pre class="code ruby"><code class="ruby">brew install rbenv/tap/openssl@1.0</code></pre>

<p>By <em>tapping</em>, Homebrew provides a way to access third-party
repositories that are usually no longer officially supported by Homebrew,
like Ruby 2.2.5 and OpenSSL-1.0. The above instruction tells Homebrew to
install compatible versions of OpenSSL-1.0 with <em>rbenv</em> (e.g.
1.0.2t, 1.0.2u).</p>

<p>Next, ensure that Homebrew and <em>rbenv</em> use OpenSSL-1.0 (at least
locally) for future, local Ruby development. Edit (or create) a user’s
local <em>~/.zshrc</em> file (instructions are here provided for zsh, the
default macOS Terminal shell interface - for bash, adapt), by pasting-in
the following:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_eval'>eval</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>$(rbenv init - zsh)</span><span class='tstring_end'>&quot;</span></span>
<span class='id identifier rubyid_export'>export</span> <span class='const'>PATH</span><span class='op'>=</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>/usr/local/opt/openssl@1.0/bin:$PATH</span><span class='tstring_end'>&quot;</span></span>
<span class='id identifier rubyid_export'>export</span> <span class='const'>LDFLAGS</span><span class='op'>=</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>-L/usr/local/opt/openssl@1.0/lib</span><span class='tstring_end'>&quot;</span></span>
<span class='id identifier rubyid_export'>export</span> <span class='const'>CPPFLAGS</span><span class='op'>=</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>-I/usr/local/opt/openssl@1.0/include</span><span class='tstring_end'>&quot;</span></span>
<span class='id identifier rubyid_export'>export</span> <span class='const'>PKG_CONFIG_PATH</span><span class='op'>=</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>/usr/local/opt/openssl@1.0/lib/pkgconfig</span><span class='tstring_end'>&quot;</span></span>
<span class='id identifier rubyid_export'>export</span> <span class='const'>RUBY_CONFIGURE_OPTS</span><span class='op'>=</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>--with-openssl-dir=$(brew --prefix openssl@1.0)</span><span class='tstring_end'>&quot;</span></span>
</code></pre>

<p>There’s probably more there than necessary, but it should do the trick for
the next few steps, and for future work. Quit the Terminal and start a new
one, or simply <em>source</em> the zshrc file:</p>

<pre class="code ruby"><code class="ruby">source ~/.zshrc</code></pre>

<p>Make sure the right OpenSSL version is recognized, and then instruct
Homebrew to switch over to it:</p>

<pre class="code ruby"><code class="ruby">openssl version
brew switch openssl 1.0.2t</code></pre>

<p>… or whatever Openssl 1.0 version was installed, e.g. 1.0.2u. Then install
<em>ruby-build</em>, <em>rbenv</em> and finally Ruby 2.2.5:</p>

<pre class="code ruby"><code class="ruby">brew install ruby-build
brew install rbenv
rbenv install 2.2.5</code></pre>

<p>Install OpenStudio 2.9.1. Then create the file
<em>~/.rbenv/versions/2.2.5/lib/ruby/site_ruby/openstudio.rb</em>, and
point it to your OpenStudio installation by editing the contents, e.g.:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_require'>require</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>/Applications/OpenStudio-2.9.1/Ruby/openstudio.rb</span><span class='tstring_end'>&#39;</span></span>
</code></pre>

<p>In the Terminal, check the Ruby version:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_ruby'>ruby</span> <span class='op'>-</span><span class='id identifier rubyid_v'>v</span>
</code></pre>

<p>It should report the current Ruby version used by macOS (e.g. ‘system’, or
&#39;2.6&#39;). To ensure Ruby 2.2.5 is used for developing OpenStudio
v2.9.1-compatible measures, a safe way is to instruct <em>rbenv</em> to use
Ruby 2.2.5 for anything within a user’s OpenStudio directory (the default
OpenStudio installation would add a /Users/user/OpenStudio folder,
containing a Measures folder):</p>

<pre class="code ruby"><code class="ruby">cd ~/OpenStudio
rbenv local 2.2.5
ruby -v</code></pre>

<p>… should report 2.2.5 as the local version of Ruby, to be used by default
for anything under the OpenStudio directory tree (including anything under
Measures). To ensure both Ruby versions are operational and safe, run the
following checkup (once from a user’s home (or ~/) directory, then from
within the local OpenStudio environment):</p>

<pre class="code ruby"><code class="ruby">cd ~/
ruby -ropen-uri -e &#39;eval open(&quot;https://git.io/vQhWq&quot;).read&#39;
cd OpenStudio
ruby -ropen-uri -e &#39;eval open(&quot;https://git.io/vQhWq&quot;).read&#39;</code></pre>

<p>If successful, one should get a <em>Hooray!</em> from both Ruby versions
confirming valid communication with <a
href="https://rubygems.org/">Rubygems</a>, yet with their specific RubyGems
and OpenSSL versions, as well as their own SSL certificates. In some cases,
(temporarily) switching over to an insecure http connection to rubygems.org
(instead of the default https) may be necessary. It may also be necessary
to first install bundler. If not, now’s a good time:</p>

<pre class="code ruby"><code class="ruby">cd ~/OpensStudio
gem install bundler -v 1.17.3</code></pre>

<p>Verify your OpenStudio and Ruby configuration:</p>

<pre class="code ruby"><code class="ruby">ruby -e &quot;require &#39;openstudio&#39;&quot; -e &quot;puts OpenStudio::Model::Model.new&quot;</code></pre>

<p>Install the latest version of <em>git</em> (e.g. through Homebrew), and
<em>git clone</em> the TBD measure under the user’s local OpenStudio
Measures directory.</p>

<p>Run the basic tests below to ensure the measure operates as expected.</p>

<h2 id="label-Complete+list+of+test+commands">Complete list of test commands</h2>

<p>Run the following (basic) tests in the root repository of the cloned TBD
measure: <code> bundle update bundle exec rake update_library_files bundle
exec rake </code></p>

<p>For more extensive testing, run the following test suites (also in the root
repository of the cloned TBD measure): <code> bundle update bundle exec
rake osm_suite:clean bundle exec rake osm_suite:run bundle exec rake
prototype_suite:clean bundle exec rake prototype_suite:run </code></p>

<p>Or run all test suites:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_bundle'>bundle</span> <span class='id identifier rubyid_update'>update</span>
<span class='id identifier rubyid_bundle'>bundle</span> <span class='id identifier rubyid_exec'>exec</span> <span class='id identifier rubyid_rake'>rake</span> <span class='id identifier rubyid_suites_clean'>suites_clean</span>
<span class='id identifier rubyid_bundle'>bundle</span> <span class='id identifier rubyid_exec'>exec</span> <span class='id identifier rubyid_rake'>rake</span> <span class='id identifier rubyid_suites_run'>suites_run</span>
</code></pre>

<h2 id="label-Support">Support</h2>

<p><em>Merci !</em> to the following organizations</p>

<p><a href="https://transitionenergetique.gouv.qc.ca"><img
src="https://github.com/rd2/tbd/blob/master/sponsors/quebec.png"></a> <a
href="https://nrc.canada.ca/en/research-development/research-collaboration/research-centres/construction-research-centre"><img
src="https://github.com/rd2/tbd/blob/master/sponsors/canada.png"></a></p>
</div></div>

      <div id="footer">
  Generated on Sat Jun 26 18:29:38 2021 by
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.9.26 (ruby-2.2.5).
</div>

    </div>
  </body>
</html>