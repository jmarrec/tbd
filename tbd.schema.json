{
  "$schema": "http://json-schema.org/draft-04/schema#",
  "id": "http://json-schema.org/automaticmagic/topolys.json#",
  "title": "TBD Schema (extension of Topolys)",
  "description": "Schema for Thermal Bridging and Derating",

  "type": "object",
  "required": [
    "psis",
    "edges"
  ],
  "properties": {
    "psis": {
      "type": "array",
      "items": {
        "$ref": "#/definitions/PSI"
      },
      "uniqueItems": true
    },
    "edges": {
      "type": "array",
      "items": {
        "$ref": "#/definitions/Edge"
      },
      "uniqueItems": true
    },
    "surfaces": {
      "type": "array",
      "items": {
        "$ref": "#/definitions/Surface"
      },
      "uniqueItems": true
    },
    "spaces": {
      "type": "array",
      "items": {
        "$ref": "#/definitions/Space"
      },
      "uniqueItems": true
    },
    "stories": {
      "type": "array",
      "items": {
        "$ref": "#/definitions/Story"
      },
      "uniqueItems": true
    },
    "units": {
      "type": "array",
      "items": {
        "$ref": "#/definitions/Unit"
      },
      "uniqueItems": true
    }
  },
  "additionalProperties": false,
  "definitions": {
    "PSI": {
      "description": "Set of PSI-values (in W/K per m) for thermal bridges",
      "type": "object",
      "required": [
        "id"
      ],
      "properties": {
        "id": {
          "type": "string"
        },
        "rimjoist": {
          "title": "Floor/wall edge PSI",
          "type": "number",
          "minimum": 0
        },
        "parapet": {
          "title": "Roof/wall or exposed-floor/wall edge PSI",
          "type": "number",
          "minimum": 0
        },
        "fenestration": {
          "title": "Window, door, skylight perimeter PSI",
          "type": "number",
          "minimum": 0
        },
        "concave": {
          "title": "Wall corner [0째,135째) PSI",
          "type": "number",
          "minimum": 0
        },
        "convex": {
          "title": "Wall corner (225째,360째] PSI",
          "type": "number",
          "minimum": 0
        },
        "balcony": {
          "title": "Floor/balcony edge PSI ",
          "type": "number",
          "minimum": 0
        },
        "party": {
          "title": "Party wall edge PSI",
          "type": "number",
          "minimum": 0
        },
        "grade": {
          "title": "Floor/foundation edge PSI",
          "type": "number",
          "minimum": 0
        }
      },
      "minProperties": 2,
      "additionalProperties": false
    },
    "Edge": {
      "description": "Surface edge as thermal bridge",
      "type": "object",
      "required": [
        "id",
        "psi",
        "length",
        "surfaces"
      ],
      "properties": {
        "id": {
          "title": "unique edge ID (set automatically by e.g. Topolys)",
          "type": "string"
        },
        "psi": {
          "title": "PSI-set ID",
          "type": "string"
        },
        "length": {
          "title": "edge length (m)",
          "type": "number",
          "minimum": 0,
          "exclusiveMinimum": true
        },
        "surfaces": {
          "title": "surfaces connected to edge",
          "type": "array",
          "items": {
            "type": "string"
          },
          "minItems": 1
        }
      },
      "additionalProperties": false
    },
    "Surface": {
      "description": "Surface default PSI-set (optional)",
      "type": "object",
      "required": [
        "id",
        "psi"
      ],
      "properties": {
        "id": {
          "title": "e.g. OS or E+ surface ID",
          "type": "string"
        },
        "psi": {
          "title": "PSI-set ID",
          "type": "string"
        }
      },
      "additionalProperties": false
    },
    "Space": {
      "description": "Space default PSI-set (optional for OS)",
      "type": "object",
      "required": [
        "id",
        "psi"
      ],
      "properties": {
        "id": {
          "title": "e.g. OS space or E+ zone ID",
          "type": "string"
        },
        "psi": {
          "title": "PSI-set ID",
          "type": "string"
        }
      },
      "additionalProperties": false
    },
    "Story": {
      "title": "Story default PSI-set (optional for OS)",
      "type": "object",
      "required": [
        "id",
        "psi"
      ],
      "properties": {
        "id": {
          "title": "e.g. OS story ID",
          "type": "string"
        },
        "psi": {
          "title": "PSI-set ID",
          "type": "string"
        }
      },
      "additionalProperties": false
    },
    "Unit": {
      "title": "Building unit default PSI-set (optional for OS)",
      "type": "object",
      "required": [
        "id",
        "psi"
      ],
      "properties": {
        "id": {
          "title": "e.g. OS unit ID",
          "type": "string"
        },
        "psi": {
          "title": "PSI-set ID",
          "type": "string"
        }
      },
      "additionalProperties": false
    }
  }
}
